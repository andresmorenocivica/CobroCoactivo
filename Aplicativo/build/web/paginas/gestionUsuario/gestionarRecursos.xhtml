<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

    <body>
        <ui:composition template="./../../plantillas/PlantillaGeneral.xhtml">
            <ui:define name="content">
                <h:form id="frmGestionRecursos">
                    <div class="content-wrapper">
                        <section class="content-header">
                            <h1>
                                Consultas
                                <small>guia formulario para consultas</small>
                            </h1>
                            <ol class="breadcrumb">
                                <li><a href="#"><i class="fa fa-dashboard"></i> Inicio</a></li>
                                <li><a href="#">Example</a></li>
                                <li class="active">Consultas</li>
                            </ol>
                        </section>
                        <section class="content">
                            <!-- Default box -->
                            <div class="box box-danger">
                                <div class="box-header with-border">
                                    <h3 class="box-title">Busquedas</h3>
                                </div>
                                <div class="box-body">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <!-- Custom Tabs -->
                                            <div class="nav-tabs-custom" >
                                                <ul class="nav nav-tabs" >
                                                    <li class="active" ><a href="#modulo" data-toggle="tab">Modulo</a></li>
                                                    <li><a href="#usuario" data-toggle="tab">Perfil</a></li>
                                                    <li><a href="#nombreRecurso" data-toggle="tab">Nombre Recurso</a></li>
                                                </ul>
                                                <div class="tab-content">
                                                    <div class="tab-pane active" id="modulo">
                                                        <br></br>
                                                        <div class="row">
                                                            <div class="col-md-3"></div>
                                                            <div class="col-xs-12 visible-xs visible-sm">
                                                                <div class="input-group margin-2">
                                                                    <label class="control-label align-left">Modulos</label>
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-3 visible-lg visible-md" style="width: 13%">
                                                                <div class="input-group margin-2">
                                                                    <label class="control-label align-left">Modulos</label>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-4 col-lg-4 col-sm-12 col-xs-12">
                                                                <div class="input-group margin-5">
                                                                    <div class="col-lg-12">
                                                                        <h:selectOneMenu  id="cmbModulos"  class="form-control" value="#{gestionRecursosBean.idModuloSeleccionado}">
                                                                            <f:selectItem itemValue="0" itemLabel="Seleccione Modulo"/>
                                                                            <f:selectItems value="#{gestionRecursosBean.listMosulo}" var="modulos" itemValue="#{modulos.id}" itemLabel="#{modulos.nombre}" /> 
                                                                        </h:selectOneMenu>

                                                                    </div>
                                                                    <span class="input-group-btn">
                                                                        <h:commandLink class="btn btn-info btn-danger" value="Buscar">
                                                                            <f:ajax event="click" listener="#{gestionRecursosBean.buscarRecursosByModulo()}" execute="frmGestionRecursos:cmbModulos" render="frmGestionRecursos:tblRecusos"/>
                                                                        </h:commandLink>
                                                                    </span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <br></br>
                                                    </div>
                                                    <!-- /.tab-pane -->
                                                    <div class="tab-pane" id="usuario">
                                                        <br></br>
                                                        <div class="row">
                                                            <div class="col-md-3"></div>
                                                            <div class="col-xs-12 visible-xs visible-sm">
                                                                <div class="input-group margin-2">
                                                                    <label class="control-label align-left">Perfil</label>
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-3 visible-lg visible-md" style="width: 13%">
                                                                <div class="input-group margin-2">
                                                                    <label class="control-label align-left">Perfil</label>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-4 col-lg-4 col-sm-12 col-xs-12">
                                                                <div class="input-group margin-5">
                                                                    <div class="col-lg-12">
                                                                        <h:selectOneMenu  id="cmbUsuario"  class="form-control" value="#{gestionRecursosBean.idPerfil}">
                                                                            <f:selectItem itemValue="0" itemLabel="Selecione Un Perfil"/>
                                                                            <f:selectItems value="#{gestionRecursosBean.listPerfiles}" var="perfil" itemValue="#{perfil.id}" itemLabel="#{perfil.nombre}" />
                                                                        </h:selectOneMenu>
                                                                    </div>
                                                                    <span class="input-group-btn">
                                                                        <h:commandLink class="btn btn-info btn-danger" value="Buscar">
                                                                            <f:ajax event="click" listener="#{gestionRecursosBean.buscarRecursosByPerfil()}" execute="frmGestionRecursos:cmbUsuario" render="frmGestionRecursos:tblRecusos"/>
                                                                        </h:commandLink>
                                                                    </span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <br></br> 
                                                    </div>
                                                    <!-- /.tab-pane -->
                                                    <div class="tab-pane" id="nombreRecurso">
                                                        <br></br>
                                                        <div class="row">
                                                            <div class="col-md-3"></div>
                                                            <div class="col-lg-3 visible-lg visible-md" style="width: 13%">
                                                                <div class="input-group margin-2">
                                                                    <label class="control-label align-left">Nombre Del Recurso</label>
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-4">
                                                                <div class="form-group">
                                                                    <div class="input-group margin-5">
                                                                        <div class="col-lg-12">
                                                                            <h:inputText id="buscarFechaIngreso" class="form-control" value="#{gestionpersonasBean.buscarFecha}" maxlength="10">
                                                                            </h:inputText><!--VALUE OK-->
                                                                        </div>
                                                                        <span class="input-group-btn">
                                                                            <h:commandLink class="btn btn-info btn-danger" value="Buscar">
                                                                            </h:commandLink>
                                                                        </span>
                                                                    </div>

                                                                </div>
                                                            </div>
                                                        </div>
                                                        <hr></hr>
                                                    </div>
                                                    <!-- /.tab-pane -->
                                                </div>
                                                <!-- /.tab-content -->
                                            </div>
                                            <!-- nav-tabs-custom -->
                                        </div>
                                        <!-- /.col -->
                                    </div>
                                </div>
                                <h:panelGroup id="tblRecusos">
                                    <table class="table table-bordered ">
                                        <thead>
                                            <tr>
                                                <th>id</th>
                                                <th>nombre</th>
                                                <th>descripcion</th>
                                                <th>Accion</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <c:forEach items="#{gestionRecursosBean.listRecurso}" var="recursos">
                                                <tr>
                                                    <td>#{recursos.codigo}</td>
                                                    <td>#{recursos.nombre}</td>
                                                    <td>#{recursos.descripcion}</td>
                                                    <td class="row">
                                                        <h:commandLink class="fa fa-pencil-square-o col-sm-4" onclick="$('#detalleRecurso').modal('show');">
                                                            <f:ajax event="click" listener="#{gestionRecursosBean.setRecurso(recursos)}" render="frmGestionRecursos:pnModalUpdate"></f:ajax>
                                                            <f:ajax event="click" listener="#{gestionRecursosBean.setEditable(false)}" render="frmGestionRecursos:pnlActualizar frmGestionRecursos:pnlGuardar"></f:ajax>
                                                        </h:commandLink>

                                                        <f:ajax event="click" render="frmGestionRecursos:detalleRecurso frmGestionRecursos:pnlActualizar frmGestionRecursos:pnlGuardar" listener="#{gestionRecursosBean.crearRegistro()}"></f:ajax>

                                                        <h:commandLink class="fa fa-trash col-sm-4" onclick="$('#eliminarRecurso').modal('show');">
                                                            <f:ajax event="click" listener="#{gestionRecursosBean.setRecurso(recursos)}"></f:ajax>
                                                        </h:commandLink> 
                                                    </td>
                                                </tr>
                                            </c:forEach>
                                        </tbody>
                                    </table>
                                </h:panelGroup>


                            </div>
                        </section>
                    </div>
                    <!-- start modal    -->
                    <div class="modal fade" id="detalleRecurso" style="overflow-y: scroll;" data-keyboard="false" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                        <div class="modal-dialog modal-lg">
                            <div class="modal-content">
                                <div class="modal-header">

                                    <h4 class="modal-title" id="myModalLabel">Actualizar Recursos</h4>
                                </div>
                                <div class="row">
                                    <div class="col-lg-12">
                                    </div>
                                </div>
                                <div class="modal-body">
                                    <p:messages closable="true" autoUpdate="true" id="msggeneral" showDetail="false" />
                                    <h:panelGroup class="col-lg-12" id="pnModalUpdate">
                                        <div class="row">
                                            <div class="modal-header">

                                            </div>
                                            <div class="col-lg-6">
                                                <div class="form-group">
                                                    <label>id</label> 
                                                    <h:inputText class="form-control" id="txtId" value="#{gestionRecursosBean.recurso.codigo}" disabled="true"/>
                                                </div>
                                            </div>
                                            <div class="col-lg-6">
                                                <div class="form-group">
                                                    <label>Nombre</label> 
                                                    <h:inputText class="form-control" id="txtNombre" value="#{gestionRecursosBean.recurso.nombre}" />
                                                </div>
                                            </div>

                                            <div class="col-lg-6">
                                                <div class="form-group">
                                                    <label>Descripción</label>
                                                    <h:inputText class="form-control" id="txtDescriptionRecurso" value="#{gestionRecursosBean.recurso.descripcion}"/>
                                                </div>
                                            </div>
                                            <div class="col-lg-6">
                                                <div class="form-group">
                                                    <label>Estado</label>
                                                    <h:selectOneMenu id="txtEstado" class="form-control" value="#{gestionRecursosBean.estadoSelecionado}">
                                                        <f:selectItems value="#{gestionRecursosBean.listaEstadoRecursos}" var="listaEstadoRecursos" itemLabel="#{listaEstadoRecursos.descripcion}" itemValue="#{listaEstadoRecursos.id}"></f:selectItems>
                                                    </h:selectOneMenu>
                                                </div>
                                            </div>
                                            <div class="col-lg-6">
                                                <div class="form-group">
                                                    <label>Fecha Inicial</label>
                                                    <h:inputText class="date datepicker form-control" id="txtFechaInicial" value="#{gestionRecursosBean.recurso.fechaInicial}">
                                                        <f:convertDateTime pattern="dd/MM/yyyy"></f:convertDateTime>
                                                    </h:inputText>
                                                </div>
                                            </div>
                                            <div class="col-lg-6">
                                                <div class="form-group">
                                                    <label>Fecha Final</label>
                                                    <h:inputText id="txtFechaFinal" class="date datepicker form-control" value="#{gestionRecursosBean.recurso.fechaFinal}" disabled="true">
                                                        <f:convertDateTime pattern="dd/MM/yyyy"></f:convertDateTime>
                                                    </h:inputText>
                                                </div>
                                            </div>
                                            <div class="col-lg-6">
                                                <div class="form-group">
                                                    <label>Carpeta</label>
                                                    <h:inputText class="form-control" id="txtCarpeta" value="#{gestionRecursosBean.recurso.carpeta}"/>
                                                </div>
                                            </div>
                                            <div class="col-lg-6">
                                                <div class="form-group">
                                                    <label>Modulo</label>
                                                    <h:selectOneMenu id="sltUsuario"   class="form-control" value="#{gestionRecursosBean.recurso.moduloId}">
                                                        <f:selectItems value="#{gestionRecursosBean.listMosulo}" var="modulos" itemValue="#{modulos.id}" itemLabel="#{modulos.nombre}" /> 

                                                    </h:selectOneMenu>
                                                </div>
                                            </div>
                                            <div class="col-lg-6">
                                                <div class="form-group">
                                                    <label>Tipo</label>
                                                    <h:selectOneMenu   class="form-control" id="sltTipo" value="#{gestionRecursosBean.idTipoRecursoSeleccionado}">
                                                        <f:selectItems value="#{gestionRecursosBean.listTipoRecursos}" var="tipoRecurso" itemValue="#{tipoRecurso.id}" itemLabel="#{tipoRecurso.descripcion}" /> 
                                                    </h:selectOneMenu>
                                                </div>
                                            </div>
                                            <div class="col-lg-6">
                                                <div class="form-group">
                                                    <label>Perfil</label>
                                                    <h:selectOneMenu   class="form-control" id="sltPerfil" value="#{gestionRecursosBean.recurso.perfilId}">
                                                        <f:selectItems value="#{gestionRecursosBean.listPerfiles}" var="perfiles" itemValue="#{perfiles.id}" itemLabel="#{perfiles.nombre}"/>
                                                    </h:selectOneMenu>
                                                </div>
                                            </div>
                                        </div>
                                    </h:panelGroup>

                                </div>
                                <div class="modal-footer">
                                    <div class="row">
                                        <div class="col-lg-8">
                                        </div>
                                        <div class="col-lg-2">
                                            <button type="button" class="btn btn-danger" data-dismiss="modal">Cancelar</button>
                                        </div>
                                        <div class="col-lg-1">
                                            <h:panelGrid id="pnlActualizar">
                                                <h:panelGroup rendered="#{!gestionRecursosBean.editable}">
                                                    <h:commandLink value="Actualizar" id="btnActualizar" class="btn btn-success" >
                                                        <f:ajax event="click" listener="#{gestionRecursosBean.update()}" render="frmTiposDatos:tablaGeneral#{tabla.id}" execute="frmGestionRecursos:txtDescriptionRecurso frmGestionRecursos:txtId frmGestionRecursos:txtEstado frmGestionRecursos:txtFechaInicial frmGestionRecursos:txtFechaFinal frmGestionRecursos:txtCarpeta frmGestionRecursos:sltUsuario frmGestionRecursos:sltTipo frmGestionRecursos:sltPerfil frmGestionRecursos:txtNombre"/>
                                                    </h:commandLink>
                                                </h:panelGroup>
                                            </h:panelGrid>
                                            <h:panelGrid id="pnlGuardar">
                                                <h:panelGroup rendered="#{gestionRecursosBean.editable}">
                                                    <h:commandLink value="Guardar" id="btnGuardarRecurso" class="btn btn-success">
                                                        <f:ajax event="click" listener="#{gestionRecursosBean.save()}" execute="frmGestionRecursos:txtDescriptionRecurso frmGestionRecursos:txtId frmGestionRecursos:txtEstado frmGestionRecursos:txtFechaInicial frmGestionRecursos:txtFechaFinal frmGestionRecursos:txtCarpeta frmGestionRecursos:sltUsuario frmGestionRecursos:sltTipo frmGestionRecursos:sltPerfil frmGestionRecursos:txtNombre" />
                                                    </h:commandLink>
                                                </h:panelGroup>
                                            </h:panelGrid>
                                        </div>
                                    </div>


                                </div>
                            </div>
                            <!-- /.modal-content -->
                        </div>
                        <!-- /.modal-dialog -->
                    </div>
                    <!-- end modal    -->

                    <div class="modal fade" id="eliminarRecurso" style="overflow-y: scroll;" data-keyboard="false" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                        <div class="modal-dialog modal-sm">
                            <div class="modal-content">
                                <div class="modal-header">

                                    <h4 class="modal-title" id="myModalLabel">Eliminar Recurso</h4>
                                </div>
                                <div class="row">
                                    <div class="col-lg-12">
                                    </div>
                                </div>
                                <div class="modal-body">
                                    <div class="row">
                                        <div class="modal-header">
                                            ¿ Esta seguro que deseas eliminar el Recurso ?
                                        </div>

                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button class="btn btn-danger" data-dismiss="modal">Cancelar</button>
                                    <h:commandLink value="Eliminar" class="btn btn-success">
                                        <f:ajax event="click" listener="#{gestionRecursosBean.eliminar()}"  render="frmTiposDatos"/>
                                    </h:commandLink>
                                </div>
                            </div>
                            <!-- /.modal-content -->
                        </div>
                        <!-- /.modal-dialog -->
                    </div>

                    <!--  floating  button  -->
                    <h:commandLink class="float" onclick="$('#detalleRecurso').modal('show');">
                        <i class="fa fa-plus my-float"></i>
                        <f:ajax event="click" render="frmGestionRecursos:txtId frmGestionRecursos:txtNombre frmGestionRecursos:txtDescriptionRecurso
                                frmGestionRecursos:txtEstado frmGestionRecursos:txtFechaInicial frmGestionRecursos:txtCarpeta frmGestionRecursos:txtFechaFinal
                                frmGestionRecursos:pnlActualizar frmGestionRecursos:pnlGuardar frmGestionRecursos:sltUsuario frmGestionRecursos:sltTipo frmGestionRecursos:sltPerfil" listener="#{gestionRecursosBean.crearRegistro()}"></f:ajax>
                    </h:commandLink> 

                   

                </h:form>
            </ui:define>
        </ui:composition>
    </body>
</html>
